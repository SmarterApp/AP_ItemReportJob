package org.opentestsystem.ap.irj.model;

import org.opentestsystem.ap.common.model.MiItem;
import org.opentestsystem.ap.common.model.MiItemCore;
import org.opentestsystem.ap.common.model.Table;
import org.opentestsystem.ap.common.model.ValidationResult;
import org.opentestsystem.ap.irj.util.ReportUtil;

import java.util.List;

import static java.lang.String.valueOf;

public class MiItemReport extends AbstractAssessmentItemReport<MiItem> {

    private final MiItemCore core;

    private final Table table;

    public MiItemReport(final MiItem item, final String reportStatus, final List<ValidationResult> validationResults) {
        super(item, reportStatus, validationResults);
        core = item.getCore();
        table = core.getEn().getTable();
    }

    @Override
    public String getMiTableColumnCount() {
        return valueOf(table.getColumns().size());
    }

    @Override
    public String getMiTableRowCount() {
        return valueOf(table.getRows().size());
    }

    @Override
    public String getMiAnswerCount() {
        return valueOf(ReportUtil.countAnswerCells(table));
    }

    @Override
    public String getMiCorrectAnswerCount() {
        return valueOf(ReportUtil.countCorrectAnswerCells(table));
    }
}

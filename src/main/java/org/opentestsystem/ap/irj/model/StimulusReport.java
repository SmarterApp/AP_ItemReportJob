package org.opentestsystem.ap.irj.model;

import lombok.Getter;
import org.opentestsystem.ap.common.model.ItemAudioResource;
import org.opentestsystem.ap.common.model.ItemMetadata;
import org.opentestsystem.ap.common.model.StimItem;
import org.opentestsystem.ap.common.model.StimItemCore;
import org.opentestsystem.ap.common.model.ValidationResult;
import org.opentestsystem.ap.irj.util.ReportUtil;

import java.util.List;

import static java.util.stream.Collectors.toList;
import static org.opentestsystem.ap.irj.util.ReportUtil.yesNo;
import static org.opentestsystem.ap.irj.util.ReportUtil.yesNoUndetermined;

public class StimulusReport extends AbstractItemReport<StimItem> {

    private final ItemMetadata metadata;

    public StimulusReport(final StimItem item, final String reportStatus, final List<ValidationResult>
            validationResults) {
        super(item, reportStatus, validationResults);
        metadata = item.getCore().getMetadata();
    }

    @Override
    public String getItemContent() {
        final StimItemCore core = getItem().getCore();
        final Content content = new Content(core);
        return ReportUtil.toJsonString(content);
    }

    @Getter
    private static class Content {

        private final String content;

        private Content(final StimItemCore core) {
            this.content = core.getEn().getContent();
        }
    }


    @Override
    public String getAslRequired() {
        return yesNoUndetermined(getItem().getAsl().getAslRequired());
    }

    @Override
    public String getAslProvided() {
        return yesNo(getItem().getAsl().isAslProvided());
    }

    @Override
    public String getTranslationRequired() {
        return yesNoUndetermined(getItem().getTranslations().getEsp().isRequired());
    }

    @Override
    public String getTranslationProvided() {
        return yesNo(getItem().getTranslations().getEsp().isProvided());
    }

    @Override
    public String getAudioProductionFilesProvided() {
        try {
            final int numberOfResources = getItem().getAudio().getAudioResources().size();

            final List<ItemAudioResource> resourcesWithProductionFiles = getItem().getAudio().getAudioResources().stream().
                    filter(ItemAudioResource::isProductionFilesProvided).collect(toList());

            return yesNo(numberOfResources == resourcesWithProductionFiles.size());
        } catch (Exception e) {
            return yesNo(false);
        }
    }

    @Override
    public String getCcProvided() {
        return yesNo(getItem().getCc().isCcProvided());
    }

    @Override
    public String getCcRequired() {
        return yesNoUndetermined(getItem().getCc().getCcRequired());
    }

    @Override
    public String getPerformanceTask() {
        return metadata.getPerformanceTask();
    }

    @Override
    public String getTestCategory() {
        return metadata.getTestCategory();
    }

    @Override
    public String getCopyrightHolderOther() {
        return metadata.getCopyrightHolderOther();
    }

    @Override
    public String getCopyrightHolder() {
        return metadata.getCopyrightHolder();
    }

    @Override
    public String getAllowCalculator() {
        return metadata.getAllowCalculator();
    }

    @Override
    public String getAlgebraDescriptor1() {
        return metadata.getAlgebraDescriptor1();
    }

    @Override
    public String getAlgebraDescriptor2() {
        return metadata.getAlgebraDescriptor2();
    }

    @Override
    public String getStructure() {
        return metadata.getStructure();
    }

    @Override
    public String getMeaningPurpose() {
        return metadata.getMeaningPurpose();
    }

    @Override
    public String getLanguageFeatures() {
        return metadata.getLanguageFeatures();
    }

    @Override
    public String getStimulusLiteraryKnowledgeDemands() {
        return metadata.getStimulusLiteraryKnowledgeDemands();
    }

    @Override
    public String getWordCount() {
        return metadata.getWordCount();
    }

    @Override
    public String getReadabilityLexile() {
        return metadata.getReadabilityLexile();
    }

    @Override
    public String getReadabilityFleschKincaid() {
        return metadata.getReadabilityFleschKincaid();
    }

    @Override
    public String getLength() {
        return metadata.getStimulusLength();
    }

    @Override
    public String getAccessibilityLanguageComplexity() {
        return metadata.getAccessibilityLanguageComplexity();
    }

    @Override
    public String getScorePoints() {
        return metadata.getScorePoints();
    }

    @Override
    public String getScoringEngine() {
        return metadata.getScoringEngine();
    }

    @Override
    public String getMaximumPoints() {
        return metadata.getMaximumPoints();
    }

    @Override
    public String getQuaternaryCommonCoreStandard() {
        return metadata.getQuaternaryCommonCoreStandard();
    }

    @Override
    public String getQuaternaryContentDomain() {
        return metadata.getQuaternaryContentDomain();
    }

    @Override
    public String getTertiaryCommonCoreStandard() {
        return metadata.getTertiaryCommonCoreStandard();
    }

    @Override
    public String getTertiaryContentDomain() {
        return metadata.getTertiaryContentDomain();
    }

    @Override
    public String getSecondaryCommonCoreStandard() {
        return metadata.getSecondaryCommonCoreStandard();
    }

    @Override
    public String getSecondaryContentDomain() {
        return metadata.getSecondaryContentDomain();
    }

    @Override
    public String getPrimaryCommonCoreStandard() {
        return metadata.getPrimaryCommonCoreStandard();
    }

    @Override
    public String getPrimaryContentDomain() {
        return metadata.getPrimaryContentDomain();
    }

    @Override
    public String getQuaternaryTarget() {
        return metadata.getQuaternaryTarget();
    }

    @Override
    public String getTertiaryTarget() {
        return metadata.getTertiaryTarget();
    }

    @Override
    public String getSecondaryTarget() {
        return metadata.getSecondaryTarget();
    }

    @Override
    public String getClaim2SubCategory() {
        return metadata.getClaim2SubCategory();
    }

    @Override
    public String getClaim2Category() {
        return metadata.getClaim2Category();
    }

    @Override
    public String getQuaternaryClaim() {
        return metadata.getQuaternaryClaim();
    }

    @Override
    public String getTertiaryClaim() {
        return metadata.getTertiaryClaim();
    }

    @Override
    public String getSecondaryClaim() {
        return metadata.getSecondaryClaim();
    }

    @Override
    public String getWritingPurpose() {
        return metadata.getWritingPurpose();
    }

    @Override
    public String getMaxGrade() {
        return metadata.getMaxGrade();
    }

    @Override
    public String getMinGrade() {
        return metadata.getMinGrade();
    }

    @Override
    public String getStimulusFormat() {
        return metadata.getStimulusFormat();
    }

    @Override
    public String getDepthOfKnowledge() {
        return metadata.getDepthOfKnowledge();
    }

    @Override
    public String getContentTaskModel() {
        return metadata.getContentTaskModel();
    }

    @Override
    public String getPrimaryTarget() {
        return metadata.getPrimaryTarget();
    }

    @Override
    public String getPrimaryClaim() {
        return metadata.getPrimaryClaim();
    }

    @Override
    public String getStimulusName() {
        return metadata.getStimulusName();
    }

    @Override
    public String getIntendedGrade() {
        return metadata.getIntendedGrade();
    }

    @Override
    public String getSubject() {
        return metadata.getSubject();
    }
}

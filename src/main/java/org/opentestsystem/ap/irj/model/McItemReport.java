package org.opentestsystem.ap.irj.model;

import lombok.Getter;
import org.opentestsystem.ap.common.model.ItemOption;
import org.opentestsystem.ap.common.model.McItem;
import org.opentestsystem.ap.common.model.McItemCore;
import org.opentestsystem.ap.common.model.ValidationResult;
import org.opentestsystem.ap.irj.util.ReportUtil;

import java.util.List;

import static java.lang.String.valueOf;

public class McItemReport extends AbstractAssessmentItemReport<McItem> {

    private final McItemCore core;

    public McItemReport(final McItem item, final String reportStatus, final List<ValidationResult> validationResults) {
        super(item, reportStatus, validationResults);
        core = item.getCore();
    }

    @Override
    public String getMcOptionCount() {
        return valueOf(core.getEn().getOptions().size());
    }

    @Override
    public String getItemContent() {
        final McItemCore core = getItem().getCore();
        final Content content = new Content(core);
        return ReportUtil.toJsonString(content);
    }

    @Getter
    private static class Content {

        private final String prompt;

        private final List<ItemOption> options;

        private Content(final McItemCore core) {
            this.prompt = core.getEn().getPrompt();
            this.options = core.getEn().getOptions();
        }
    }

}
